<!--
* Start Bootstrap - Shop Homepage v5.0.6 (https://startbootstrap.com/template/shop-homepage)
* Copyright 2013-2023 Start Bootstrap
* Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-shop-homepage/blob/master/LICENSE)
-->
<!--
 * Bootstrap  v5.2.3 (https://getbootstrap.com/)
 * Copyright 2011-2022 The Bootstrap Authors
 * Copyright 2011-2022 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
-->
{% extends "layout.html" %}
{% block title %}REFILM{% endblock %}

{% block content %}
        <!-- Header-->
        <header class="bg-dark py-5">
            <div class="container px-4 px-lg-5 my-5">
                <div class="text-center text-white">
                    <h1 class="display-4 fw-bolder">폐필름통의 변신, 나만의 커스텀 소품으로!</h1>
                    <p class="lead fw-normal text-white-50 mb-0">지금 바로 환경을 지키는 스마트한 선택을 해보세요</p>
                    <!-- Search form -->
                    <form action="/search" method="get" class="form-inline d-flex justify-content-center mt-4">
                        <input type="text" id="search-input" list="suggestions-list" name="search" class="form-control form-control-lg mr-2" style="width: 50%;">
                        <datalist id="suggestions-list"></datalist>
                        <button type="submit" class="btn btn-success btn-lg">Search</button>
                    </form>
                </div>
            </div>
        </header>
        <!-- Section-->
        <section class="py-5">
            <div class="container px-4 px-lg-5 mt-5">
                <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
                    <div class="col mb-5">
                        <div class="card h-100">
                            <!-- Product image-->
                            <a style="color: black; text-decoration:none" href="#">
                                <img class="card-img-top" src="/static/pictures/customization.jpg" alt="..." />
                                <!-- Product details-->
                                <div class="card-body p-4">
                                    <div class="text-center">
                                        <!-- Product name-->
                                        <h5 class="fw-bolder">주문 제작</h5>
                                        <!-- Product reviews-->
                                        <div class="d-flex justify-content-center small text-warning mb-2">
                                            <div class="bi-star-fill"></div>
                                            <div class="bi-star-fill"></div>
                                            <div class="bi-star-fill"></div>
                                            <div class="bi-star-fill"></div>
                                            <div class="bi-star-fill"></div>
                                        </div>
                                        <!-- Product quantity, price-->
                                        
                                    </div>
                                </div>
                            </a>
                            <!-- Product actions-->                            
                            <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                                <div class="text-center">
                                    <input type="hidden" name="quantity" value="1">
                                    <button type="submit" class="btn btn-outline-dark mt-auto">Customization</button>
                                </div>
                            </div>                            
                        </div>
                    </div>
                    {% for product in products %}
                        <div class="col mb-5">
                            <div class="card h-100">
                                <!-- Product image-->
                                <a style="color: black; text-decoration:none" href="/product/{{ product.product_id }}">
                                    <img class="card-img-top" src="/static/product_images/product{{ product.product_id }}.{{ product.image_extension }}" alt="..." />
                                    <!-- Product details-->
                                    <div class="card-body p-4">
                                        <div class="text-center">
                                            <!-- Product name-->
                                            <h5 class="fw-bolder">{{ product.product_name }}</h5>
                                            <!-- Product reviews-->
                                            <div class="d-flex justify-content-center small text-warning mb-2">
                                                <div class="bi-star-fill"></div>
                                                <div class="bi-star-fill"></div>
                                                <div class="bi-star-fill"></div>
                                                <div class="bi-star-fill"></div>
                                                <div class="bi-star-fill"></div>
                                            </div>
                                            <!-- Product quantity, price-->
                                            재고 : {{ product.quantity }}개
                                            <br>₩{{ product.price }}
                                        </div>
                                    </div>
                                </a>
                                <!-- Product actions-->
                                <form action="/add_to_cart/{{ product.product_id }}" method="post">
                                    <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                                        <div class="text-center">
                                            <input type="hidden" name="quantity" value="1">
                                            <button type="submit" class="btn btn-outline-dark mt-auto">Add to cart</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </section>
        <script>
            // waits for the DOM to be fully loaded before running the script
            document.addEventListener('DOMContentLoaded', function() {
                // gets the search input and suggestions list elements
                const searchInput = document.getElementById('search-input');
                const suggestionsList = document.getElementById('suggestions-list');
                
                // listens for input event on search input
                searchInput.addEventListener('input', function() {
                    const query = searchInput.value;
                    // if the query is at least 2 characters long
                    if (query.length >= 2) {
                        // fetches the suggestions from the server
                        fetch(`/autocomplete?search=${query}`)
                            .then(response => response.json())
                            .then(data => {
                                // clears the suggestions list
                                suggestionsList.innerHTML = '';
                                // appends the suggestions to the suggestions list
                                data.forEach(item => {
                                    const option = document.createElement('option');
                                    option.value = item;
                                    suggestionsList.appendChild(option);
                                });
                            });
                    } else {
                        suggestionsList.innerHTML = '';
                    }
                });
            });
        </script>
{% endblock %}
